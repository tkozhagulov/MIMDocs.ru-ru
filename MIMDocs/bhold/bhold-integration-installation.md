---
title: Установка модуля BHOLD FIM/MIM Integration | Документация Майкрософт
description: Модуль BHOLD Integration добавляет возможности управления ролями самообслуживания в MIM и FIM.
keywords: ''
author: barclayn
ms.author: barclayn
manager: mbaldwin
ms.date: 09/12/2017
ms.topic: article
ms.service: microsoft-identity-manager
ms.technology: security
ms.assetid: ''
ms.openlocfilehash: 08a0aaa60891727482e80c8998cc075eacf042cf
ms.sourcegitcommit: 35f2989dc007336422c58a6a94e304fa84d1bcb6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2018
ms.locfileid: "36290175"
---
# <a name="bhold-fimmim-integration-installation"></a>Установка модуля BHOLD FIM/MIM Integration

Модуль BHOLD FIM Integration привносит возможности управления ролями самообслуживания в Майкрософт Identity Manager, в результате чего пользователи могут запрашивать дополнительные роли и назначать их другим пользователям. Модуль BHOLD FIM Integration расширяет функциональность портала FIM, чтобы упростить управление ролями пользователей в рамках общего администрирования FIM. В этом разделе описывается настройка сетевой инфраструктуры для установки и использования модуля BHOLD FIM Integration. Здесь также описывается установка модуля BHOLD FIM Integration и его последующая настройка.

## <a name="bhold-fim-integration-installation-requirements"></a>Требования к установке модуля BHOLD FIM

Модуль BHOLD FIM Integration расширяет функциональность портала FIM и службы FIM и разрешает пользователям управлять ролями на портале FIM. Поэтому перед установкой модуля BHOLD FIM Integration важно установить и настроить модуль BHOLD Core и необходимые функции FIM.
Ниже приведены программные компоненты, которые должны быть установлены на компьютере до установки модуля BHOLD FIM Integration.

- Портал и служба Microsoft Identity Manager 2016
- Microsoft Silverlight 3 или более поздняя версия
- Службы IIS и ASP.NET
- Средства Microsoft Silverlight

Кроме того, модуль BHOLD Core и модуль соединителя управления доступом уже должны быть развернуты на сервере, а служба FIM должна быть настроена с одним агентом управления BHOLD или несколькими. Сведения об установке и настройке модуля BHOLD Core см. в статье [BHOLD Core Installation](https://technet.microsoft.com/library/jj134095(v=ws.10).aspx) (Установка модуля BHOLD Core). Сведения об установке и использовании модуля соединителя управления доступом см. в статьях [Access Management Connector Installation](https://technet.microsoft.com/library/jj874042(v=ws.10).aspx) (Установка соединителя управления доступом) и [Test Lab Guide: BHOLD Access Management Connector](https://technet.microsoft.com/library/jj853085(v=ws.10).aspx) (Руководство по лаборатории тестирования: соединитель управления доступом BHOLD).

> [!IMPORTANT]
> База данных службы FIM должна носить имя FIMService. Установка модуля BHOLD FIM Integration завершится ошибкой, если служба FIM не была установлен с именем базы данных службы FIM по умолчанию.

## <a name="before-you-begin"></a>Подготовка к работе

Перед установкой модуля BHOLD FIM Integration необходимо создать каталог BHOLD в корневом каталоге диска C: (C:\BHOLD).

Кроме того, необходимо подготовить сведения, которые потребуются мастеру установки модуля BHOLD FIM Integration для завершения установки. Сведения в следующей таблице помогут пройти все шаги мастера.

### <a name="bholdfim-account-settings"></a>Параметры учетной записи BHOLDFim

| **Элемент**                            | **Описание**                                                                                                                                                                                                               | **Значение**                                                                                                                                                                                                                                                                                                            |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Использовать поставщик безопасности в домене или на компьютере** | Выбранный параметр указывает, что система безопасности доменных служб Active Directory управляет доступом к модулю BHOLD Core.                                                                                                                    | Установите требуемый флажок. **Важно**. Если этот флажок не установлен, установка завершится ошибкой.                                                                                                                                                                                                                   |
| **Домен**                          | Указывает домен, содержащий **учетную запись службы**, созданную при установке модуля BHOLD Core. Дополнительные сведения см. в статье [BHOLD Core Installation](https://technet.microsoft.com/library/jj134095(v=ws.10).aspx) (Установка модуля BHOLD Core). | Мастер автоматически задает имя домена. Если имя указано неверно, измените его. **Важно**. Укажите имя домена, используя краткое имя NetBIOS, а не полное доменное имя (FQDN). Например, если полное доменное имя — fabrikam.com, укажите имя домена как FABRIKAM. |
| **Имя пользователя**                        | Указывает имя входа для учетной записи службы BHOLD Core.                                                                                                                                                              | Запишите имя учетной записи пользователя:                                                                                                                                                                                                                                                                                    |
| **Пароль**                        | Задает пароль для учетной записи пользователя службы.                                                                                                                                                                           | Запишите пароль: **Важно**. Пароль необходимо хранить в безопасном и надежном месте.                                                                                                                                                                                                                  |

### <a name="fim-service-settings"></a>Параметры службы FIM

| **Элемент**            | **Описание**                                                                                                                                                                                                                               | **Значение**                                                                                           |
|---------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| **User**            | Указывает имя входа учетной записи с правами администратора для службы FIM. Корпорация Майкрософт настоятельно рекомендует не использовать учетную запись, связанную с привилегированным пользователем в модуле BHOLD Core (по умолчанию учетная запись используется для установки модуля BHOLD Core). | Запишите имя учетной записи пользователя:                                                                   |
| **Пароль**        | Задает пароль для учетной записи администратора службы FIM.                                                                                                                                                                                 | Запишите пароль: **Важно**. Пароль необходимо хранить в безопасном и надежном месте. |
| **База данных FIM**    | Указывает имя базы данных службы FIM.                                                                                                                                                                                               | FIMService                                                                                          |
| **IP-адрес или порт веб-сайта** | Указывает имя или IP-адрес сервера портала FIM и порт веб-сайта.                                                                                                                                                               | Запишите имя сервера или адрес и порт:                                                     |

### <a name="bhold-core-connection"></a>Подключение BHOLD Core

| **Элемент**               | **Описание**                                                                                                                                                                                                                                                                                                                                                                               | **Значение**                                                                                           |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| **Домен**             | Указывает имя домена учетной записи, указанной в разделе **Пользователи** ниже. Укажите домен в кратком формате NetBIOS.                                                                                                                                                                                                                                                                   | Запишите имя домена учетной записи пользователя:                                                            |
| **User**               | Указывает имя входа учетной записи **пользователя BHOLD, который является руководителем** всех пользователей и ролей и имеет разрешение на создание и удаление связей ролей пользователей. Корпорация Майкрософт настоятельно рекомендует не использовать учетную запись, связанную с привилегированным пользователем в модуле BHOLD Core (по умолчанию учетная запись используется для установки модуля BHOLD Core). Эта учетная запись может быть той же учетной записью, которая используется для подключения к FIM. | Запишите имя учетной записи пользователя:                                                                   |
| **Пароль**           | Указывает пароль учетной записи пользователя, заданный в разделе **Пользователь**.                                                                                                                                                                                                                                                                                                                             | Запишите пароль: **Важно**. Пароль необходимо хранить в безопасном и надежном месте. |
| **IP-адрес компьютера** | Указывает IP-адрес сервера веб-сайта BHOLD Core. Не используйте имя сервера.                                                                                                                                                                                                                                                                                                        | Запишите IP-адрес:                                                                          |
| **Номер порта**        | Указывает номер порта веб-сайта BHOLD Core.                                                                                                                                                                                                                                                                                                                                          | Запишите номер порта:                                                                         |

## <a name="bhold-fim-integration-setup"></a>Установка модуля BHOLD FIM

Чтобы установить модуль BHOLD FIM Integration, войдите в систему как член группы "Администраторы домена", скачайте следующий файл и запустите его от имени администратора на сервере, где вы собираетесь установить модуль BHOLD FIM Integration:

- BholdFIMIntegration<em>\<версия\></em>\_Release.msi

Замените *\<версия\>* на номер версии устанавливаемого выпуска BHOLD FIM Integration.

Чтобы запустить файл программы от имени администратора, щелкните его правой кнопкой мыши и выберите пункт **Запуск от имени администратора**.

![запуск msi](media/bhold-integration-installation/cmd.png)

## <a name="post-installation-tasks"></a>Задачи, выполняемые после установки

После установки модуля BHOLD FIM Integration необходимо настроить Microsoft SharePoint для предоставления учетной записи службы BHOLD разрешений владельца сайта. Кроме того, если портал FIM настроен на использование безопасности SSL, необходимо изменить файлы, которые содержат ссылки на адреса страниц BHOLD, добавленных на портал FIM.

### <a name="configuring-sharepoint"></a>Настройка SharePoint

Для правильной работы модуля BHOLD FIM Integration требуется, чтобы учетная запись службы BHOLD имела разрешения участника сайта в Microsoft SharePoint.

### <a name="to-grant-site-member-permissions-to-the-bhold-service-account"></a>Предоставление разрешений участника сайта для учетной записи службы BHOLD

1.  Войдите на сервер, где запущен модуль BHOLD FIM Integration, с правами администратора.

2.  Щелкните **Пуск** и выберите **Internet Exporer**.

3.  В адресной строке введите <https://localhost>, если SharePoint настроен для использования безопасности SSL, в противном случае введите <http://localhost>.

4.  В левой части страницы **Сайт группы** щелкните **Пользователи и группы**.

5.  В разделе **Группы** щелкните **Участники сайта группы**, а на центральной панели инструментов щелкните **Создать**, а затем —**Добавить пользователей**.

6.  На странице **Добавление пользователей: сайт группы** в разделе **Пользователи и группы** введите BHOLDApplicationGroup, а затем нажмите кнопку "Проверить имена" в разделе **Пользователи и группы**. Имя группы должно включать имя домена.

7.  Щелкните **Предоставить следующие разрешения**, выберите **Full Control – Has full control** (Полный доступ без ограничений — полный доступ)и нажмите кнопку **ОК**.

8.  Убедитесь, что группа BHOLDApplicationGroup указана в разделе **Разрешения: сайт группы**, а затем закройте Internet Explorer.

![запуск msi](media/bhold-integration-installation/sharepoint.png)

### <a name="configuring-bhold-to-support-ssl"></a>Настройка BHOLD для поддержки протокола SSL

Если портал FIM настроен на использование безопасности SSL, необходимо изменить файлы на сервере FIM так, чтобы открывались ссылки на страницы BHOLD. Файлы находятся в следующей папке: ```C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\BHOLD```.

Ниже перечислены файлы, а также исходные и измененные версии строк, которые нужно отредактировать.

| **Файл**                  | **Исходная строка**                                                                                                                   | **Измененная строка**                                                                                                                                |
|---------------------------|---------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| Analytics.aspx            |   http://<сервер_BHOLD>/BHOLD/Analytics/index_fim.HTML | https://<полное_доменное_имя_сервера_BHOLD>/bhold/Analytics/index_fim.html       |
| AttestationCampaigns.aspx |    http://<сервер_BHOLD>/bhold/Attestation/Campaigns.aspx?hideMenu=1 | https://<полное_доменное_имя_сервера_BHOLD>/bhold/Attestation/Campaigns.aspx?hideMenu=1 | 
| AttestationMain.aspx      |  http://<сервер_BHOLD>/bhold/Attestation/Dashboard.aspx?hideMenu=1        | https://<полное_доменное_имя_сервера_BHOLD>/bhold/Attestation/Dashboard.aspx?hideMenu=1 |
| Reporting.aspx            | http://<сервер_BHOLD>/bhold/Reporting/index_fim.html |  https://<полное_доменное_имя_сервера_BHOLD>/bhold/Reporting/index_fim.html |
| Selfservice.aspx          | RoleExchangePoint=http://\<*сервер_FIM*\>: \<*порт_FIM*\>/BHOLD/RoleExchangePoint/ BHOLDRoleExchangePoint.svc,TransportMode=Transport | RoleExchangePoint=https://\<*полное_доменное_имя_сервера_FIM*\>: \<*порт_SSL_FIM\>*\>/BHOLD/RoleExchangePoint/ BHOLDRoleExchangePoint.svc,TransportMode=Transport |

Где:

-   *\<сервер_BHOLD\>*  — имя сервера BHOLD, как определено в исходной версии файла.

-   *\<сервер_MIM\>*  — имя сервера FIM, как определено в исходной версии файла.

-   *\<полное_доменное_имя_сервера_BHOLD\>*  — полное доменное имя (FQDN) сервера BHOLD.

-   *\<порт_MIM\>*  — номер порта сервера FIM, как определено в исходной версии файла.

-   *\<полное_доменное_имя_сервера_MIM\>*  — полное доменное имя сервера FIM.

-   *\<MIM_SSL_Port\>*  — другой порт для использования с SSL на сервере FIM.

### <a name="enable-approval-workflows-in-bhold-core"></a>Включение рабочих процессов утверждений в BHOLD Core

При интеграции FIM и BHOLD для самообслуживания рабочие процессы для утверждений выполняются в службе FIM. Это аналогично модели рабочих процессов для запросов, поступающих с портала FIM, например когда пользователь отправляет запрос на включение в список рассылки. Но между рабочими процессами ролей BHOLD и другими рабочими процессами, размещенными в службе FIM, существует ряд ключевых различий. При использовании BHOLD параметры рабочего процесса, которые определяют, какие пользователи должны утверждать запрос роли, создаются в BHOLD, а не хранятся в определениях рабочих процессов в базе данных службы FIM. Эти параметры BHOLD предоставляются службе FIM при первом запросе, а рабочий процесс действия передает результаты обратно в BHOLD Core.

BHOLD выбирает утверждающего для запроса на самообслуживание одним из трех способов.

-   **Руководитель в качестве утверждающего: выбор на основе ролей для подразделения**. Если роль имеет атрибут с именем roletype, которому задано значение "Утверждающий" или "Лицо для эскалации", или если эта роль связана с одним пользователем или несколькими в контексте подразделения, запросы от пользователей в этом подразделении должны быть утверждены одним из пользователей, который привязан к роли с типом "Утверждающий" или "Лицо для эскалации".

-   **Руководитель в качестве утверждающего: выбор на основе атрибутов для подразделения**. Каждое подразделение может иметь один атрибут или несколько, указывающих псевдонимы пользователей, которые могут утверждать назначения ролей для других пользователей в подразделении. Эти атрибуты носят имена "approver1", "approver2" и т. д. Когда пользователь в подразделении запрашивает назначение роли, BHOLD перенаправляет запрос (через FIM) пользователям, указанным атрибутами утверждающего в подразделении. Если в подразделении эти атрибуты не заданы, BHOLD проверяет родительское подразделение вплоть до корневого подразделения.

-   **Управляющий ролями в качестве утверждающего: выбор на основе атрибутов для роли**. Роль может иметь один атрибут или несколько (с именами "approver1" и т. д.), указывающих псевдонимы пользователей, которые могут утверждать назначения ролей. Когда пользователь запрашивает назначение роли с заданными атрибутами утверждающего, BHOLD направляет запрос пользователям, указанным атрибутами.

Если утверждающий для запроса роли самообслуживания не указан, по умолчанию BHOLD автоматически назначит роли без утверждения. По этой причине сразу же после установки модуля BHOLD FIM Integration необходимо настроить корневое подразделение с псевдонимом утверждающего, например учетной записи root. Это не позволит случайно предоставить пользователю роль до реализации более комплексной политики утверждения.

#### <a name="to-configure-an-approver-for-the-root-orgunit"></a>Настройка утверждающего для корневого подразделения

1.  Войдите на сервер BHOLD Core с правами администратора.

2.  Щелкните **Пуск** и выберите **Internet Exporer**.

3.  В адресной строке Internet Explorer введите <http://localhost:5151/bhold/core> и нажмите клавишу ВВОД.

4.  На домашней странице BHOLD Core в разделе **Attribute def** (Определения атрибутов) щелкните **Типы атрибутов**.

5.  На странице **Тип атрибута** нажмите кнопку **Добавить**.

6.  На странице **Добавление типа атрибута** в поле **Удостоверение** введите "approver1", в списке **Тип данных** выберите **Буквенно-цифровой**, в поле **Максимальная длина** введите 255, в разделе **Список значений** щелкните **Нет**, в поле **English** введите "Approver 1", нажмите кнопку **ОК**, а затем нажмите кнопку **Готово**.

7.  В левой области в разделе **Attribute def** (Определения атрибутов) щелкните **Наборы типов атрибутов**.

8.  На странице **Наборы типов атрибутов** нажмите кнопку **Добавить**.

9.  На странице **Добавление набора типов атрибутов** в поле **Описание** введите "OrgUnit Attributes" (Атрибуты подразделения), а затем нажмите кнопку **ОК**.

10. На странице **Атрибуты подразделения** разверните узел **Типы атрибутов**, а затем нажмите кнопку **Изменить**.

11. В списке **Тип атрибута** выберите **approver1**, нажмите кнопку **добавить**, а затем нажмите кнопку **Готово**.

12. На левой панели выберите **Типы объектов**.

13. На странице **Типы объектов** щелкните **Подразделение**.

14. На странице **Тип объекта или подразделение** разверните узел **Наборы типов атрибутов**, а затем нажмите кнопку **Изменить**.

15. На странице **Link attribute type set/OrgUnit** (Связать набор типов атрибутов/подразделение) в поле **Порядок** введите "10", в списке **Набор типов атрибутов** выберите **Атрибуты подразделения**, нажмите кнопку **Добавить**, а затем нажмите кнопку **Готово**.

16. В левой области в разделе **Модель** щелкните **Подразделения**.

17. На странице **Подразделения** щелкните **root**.

18. На странице **Подразделение/root** щелкните **Изменить**.

19. На странице **Modify organizational unit attributes/root** (Изменение атрибутов подразделения/root) в поле **Утверждающий** введите имя домена и имя пользователя, который будет утверждать запросы на назначение ролей, в формате *\<домен\>*\\*\<пользователь\>*, где *\<домен\>*  — краткое имя домена NetBIOS, а *\<пользователь\>*  — имя пользователя для входа.
20. Нажмите кнопку **ОК**.

> [!IMPORTANT]
> Имя домена и имя пользователя должны совпадать с заданным по умолчанию псевдонимом пользователя в базе данных BHOLD Core.

В качестве альтернативы указания утверждающего для подразделений можно указать утверждающего для предложенных ролей в базе данных BHOLD Core. Для этого, создайте атрибут approver1, добавьте его в набор типов атрибутов, связанный с типом объекта роли, и измените каждую предложенную роль для указания утверждающего.

Для повышения уровня безопасности рабочего процесса помимо утверждающих следует назначить дополнительные режимы утверждения и пользователей, создав и заполнив следующие атрибуты для подразделений и ролей:

- escalator<em>\<n\></em>

- owner<em>\<n\></em>

- securityOfficer<em>\<n\></em>

- notification<em>\<n\></em>

где *\<n\>* означает необязательный числовой суффикс для предоставления нескольких атрибутов одного типа.

### <a name="verify-approval-workflows-configured-in-the-fim-service"></a>Проверка рабочих процессов утверждений, настроенных в службе FIM

В ходе установки модуля BHOLD FIM Integration создаются наборы, определения рабочих процессов и правила политики управления (MPR) в службе FIM. Если вы настроили развертывание FIM для изменения наборов администраторов или наборов пользователей, которые могут выполнять запросы, следует убедиться, что правила MPR ссылаются на правильные имена наборов.

> [!NOTE]
> Прежде чем пользователи портала FIM могут применять возможности самообслуживания, предоставляемые BHOLD, учетные записи пользователей должны быть синхронизированы в базу данных BHOLD из службы синхронизации FIM. В частности, в базе данных BHOLD и базе данных службы FIM должна быть запись пользователя для каждого пользователя, который может делать запросы на самообслуживание или который указан как утверждающий или лицо для эскалации для таких запросов.

## <a name="next-steps"></a>Дальнейшие шаги

- Сведения об установке портала FIM и других функциональных возможностях FIM см. в статье [Планирование и архитектура](https://technet.microsoft.com/library/ee808044.aspx) в технической библиотеке Microsoft Forefront.
- [Руководство по установке BHOLD](bhold-installation-guide.md)
- [Справочник разработчика BHOLD](../reference/mim2016-bhold-developer-reference.md)
- [Журнал версий BHOLD](../reference/version-bhold-history.md)
