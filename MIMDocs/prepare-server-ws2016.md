---
title: Настройка Windows Server 2016 для MIM 2016 с пакетом обновления 1 (SP1) | Документация Майкрософт
description: Пошаговые инструкции и сведения о минимальных требованиях для подготовки Windows Server 2016 к работе с MIM 2016 с пакетом обновления 1 (SP1).
keywords: ''
author: billmath
ms.author: billmath
manager: mtillman
ms.date: 04/26/2018
ms.topic: get-started-article
ms.prod: microsoft-identity-manager
ms.assetid: 51507d0a-2aeb-4cfd-a642-7c71e666d6cd
ms.reviewer: mwahl
ms.suite: ems
ms.openlocfilehash: a0fa1e837fd73872043748ee73f19a29d1d1412f
ms.sourcegitcommit: 3b514aba69af203f176b40cdb7c2a51c477c944a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2018
ms.locfileid: "51718334"
---
# <a name="set-up-an-identity-management-server-windows-server-2016"></a>Настройка сервера управления удостоверениями: Windows Server 2016

> [!div class="step-by-step"]
> [" Подготовка домена](preparing-domain.md)
> [SQL Server 2016 "](prepare-server-sql2016.md)
> 
> [!NOTE]
> В этом пошаговом руководстве используются примеры имен и значений для компании Contoso. Замените их своими значениями. Пример.
> - Имя контроллера домена — **corpdc**
> - Имя домена — **contoso**.
> - Имя сервера службы MIM — **corpservice**
> - Имя сервера синхронизации MIM — **corpsync**
> - Имя SQL Server — **corpsql**
> - Пароль — <strong>Pass@word1</strong>

## <a name="join-windows-server-2016-to-your-domain"></a>Присоединение Windows Server 2016 к своему домену

Создайте машину Windows Server 2016 с ОЗУ от 8 до 12 ГБ. При установке выберите версию сервера "Windows Server 2016 Standard/Datacenter (сервер с графическим интерфейсом пользователя) x64".

1. Войдите на новый компьютер от имени администратора.

2. С помощью панели управления назначьте компьютеру статический IP-адрес в сети. Настройте ее сетевой интерфейс на отправку запросов DNS по IP-адресу контроллера домена, упомянутого ранее, и задайте имя компьютера **CORPSERVICE**.  Для выполнения этой операции потребуется перезагрузить сервер.

3. Откройте панель управления и присоедините компьютер к домену *contoso.com*, настроенному на предыдущем шаге.  В ходе выполнения этой операции потребуется указать имя пользователя и учетные данные администратора домена, например *Contoso\Administrator*.  Когда появится приветствие, закройте диалоговое окно и снова перезагрузите сервер.

4. Войдите на компьютер *CORPSERVICE* с помощью доменной учетной записи с правами администратора локального компьютера, такой как *Contoso\MIMINSTALL*.


5. Откройте окно PowerShell от имени администратора и введите следующую команду, чтобы обновить компьютер согласно параметрам групповой политики.

    ```
    gpupdate /force /target:computer
    ```

    Не позже чем через минуту обновление будет завершено с сообщением "Обновление политики для компьютера успешно завершено".

6. Добавьте роли **Веб-сервер (IIS** и **Сервер приложений**, компоненты **.NET Framework** 3.5, 4.0 и 4.5, а также модуль **Active Directory для Windows PowerShell**.

    ![Изображение для компонентов PowerShell](media/MIM-DeployWS2.png)

7. В PowerShell введите следующие команды: Обратите внимание, что может потребоваться указать другое расположение исходных файлов для компонентов **.NET Framework** 3.5. Эти компоненты обычно отсутствуют при установке Windows Server, но доступны в папке параллельного размещения (SxS), находящейся в папке sources на установочном диске ОС, например "\*d:\Sources\SxS\*".

    ```
    import-module ServerManager
    Install-WindowsFeature Web-WebServer, Net-Framework-Features,rsat-ad-powershell,Web-Mgmt-Tools,Application-Server,Windows-Identity-Foundation,Server-Media-Foundation,Xps-Viewer –includeallsubfeature -restart -source d:\sources\SxS
    ```

## <a name="configure-the-server-security-policy"></a>Настройка политики безопасности сервера

Настройте политику безопасности сервера так, чтобы новые учетные записи могли работать как службы.
> [!NOTE] 
> В зависимости от типа конфигурации сервера как автономного (все в одном) или распределенного, необходимо только добавить компьютер на основе роли компьютера-члена домена, такой как сервер синхронизации. 

1. Запуск программы локальной политики безопасности

2. Перейдите в раздел **Локальные политики > Предоставление прав пользователям**.

3. В области сведений щелкните правой кнопкой мыши команду **Вход в качестве службы** и выберите пункт **Свойства**.

    ![Изображение для локальной политики безопасности](media/MIM-DeployWS3.png)

4. Нажмите кнопку **добавить пользователя или группу**, и в текстовом поле введите следующие данные на основе роли `contoso\MIMSync; contoso\MIMMA; contoso\MIMService; contoso\SharePoint; contoso\SqlServer; contoso\MIMSSPR`, нажмите кнопку **проверить имена**, а затем нажмите кнопку **ОК**.

5. Нажмите кнопку**ОК** , чтобы закрыть окно свойств **Вход в качестве службы**.

6.  В области сведений щелкните правой кнопкой мыши команду **Отказать в доступе к этому компьютеру из сети** и выберите пункт **Свойства**.

[!NOTE] Разделение ролей серверов нарушит работу некоторых функций, например SSPR.

7. Щелкните **Добавить пользователя или группу**, после чего введите `contoso\MIMSync; contoso\MIMService` в текстовом поле и нажмите кнопку **ОК**.

8. Нажмите кнопку **ОК**, чтобы закрыть окно свойств **Отказать в доступе к этому компьютеру из сети**.

9. В области сведений щелкните правой кнопкой мыши команду **Запретить локальный вход** и выберите пункт **Свойства**.

10. Щелкните **Добавить пользователя или группу**, после чего введите `contoso\MIMSync; contoso\MIMService` в текстовом поле и нажмите кнопку **ОК**.

11. Нажмите **ОК** , чтобы закрыть окно свойств **Запретить локальный вход**.

12. Закройте окно "Локальная политика безопасности".


## <a name="change-the-iis-windows-authentication-mode-if-needed"></a>По необходимости измените систему аутентификации на IIS в Windows

1.  Откройте окно PowerShell.

2.  Остановите службы IIS с помощью команды *iisreset /STOP*.

    ```
    iisreset /STOP
    C:\Windows\System32\inetsrv\appcmd.exe unlock config /section:windowsAuthentication -commit:apphost
    iisreset /START
    ```

> [!div class="step-by-step"]  
> [" Подготовка домена](preparing-domain.md)
> [SQL Server 2016 "](prepare-server-sql2016.md)
