---
title: "Регистрация смарт-карт для пользователей, не являющихся администраторами | Microsoft Identity Manager"
description: "Узнайте, как зарегистрировать смарт-карты на компьютерах пользователей без прав администратора, чтобы они могли использовать диспетчер сертификатов."
keywords: 
author: kgremban
manager: stevenpo
ms.date: 04/28/2016
ms.topic: article
ms.prod: identity-manager-2015
ms.service: microsoft-identity-manager
ms.technology: security
ms.assetid: bfabc562-a2f0-4cff-ac31-36927f41e102
ms.reviewer: mwahl
ms.suite: ems
translationtype: Human Translation
ms.sourcegitcommit: 875ed6b96929822ac166a4a262cc8547a4ea3b2a
ms.openlocfilehash: 50c0edd60abfa6550cb5a873d32a842e8c099811


---

# Регистрация смарт-карт для пользователей, не являющихся администраторами
Если пользователь не является локальным администратором на компьютере, по умолчанию он не сможет зарегистрировать смарт-карту на своих компьютерах. Представленная ниже процедура позволяет обойти это ограничение.

## Включение обновления смарт-карты для пользователей без прав администратора в диспетчере сертификатов MIM 2016

1.  **Распакуйте APPX-файл**

    Получите сертификат подписи. Выполните действия, чтобы [войти в приложение Windows 8 с помощью внутренней PKI](http://blogs.technet.com/b/deploymentguys/archive/2013/06/14/signing-windows-8-applications-using-an-internal-pki.aspx). Остановитесь перед этапом "Подпись приложения". Присвойте имя экспортированному PFX-файлу. Экспортируйте CER-файл и импортируйте его в клиент с помощью CER.-файла нового сертификата подписи.

    Чтобы распаковать APPX-файл, выполните следующие действия:

    `makeappx unpack /l /p <app package name>.appx /d ./appx`

    `ren <app package name>.appx <app package name>.appx.old`

    `cd appx`

2.  **Изменение файла конфигурации**

    Переименуйте файл `CustomDataExample.xml custom.data`. Приложение CM попытается найти этот файл.

    Отредактируйте файл custom.data, изменив следующее:

    1.  В элементе &lt;NonAdmin&gt; измените значение атрибута Value на True

    2.  Сохраните файл и закройте редактор.

    3.  Удалите файл AppxSignature.p7x.

    4.  Отредактируйте файл AppxManifest.xml.

    5.  В элементе &lt;Identity&gt; измените значение атрибута Publisher на тему сертификата подписи, например "CN=ABCD"

        Эта тема должна совпадать с темой в сертификате, используемом для подписи приложения.

    6.  Сохраните файл и закройте редактор.

3.  **Заново упакуйте и подпишите пакет приложения (APPX-файл).**

    Чтобы упаковать и подписать APPX-файл, выполните следующие команды:

    `cd ..`

    `makeappx pack /l /d .\appx /p <app package name>.appx`

    s`igntool sign /f <path\>mysign.pfx /p <pfx password> /fd "sha256" <app package name>.appx`

4.  Дублируйте шаблон профиля и добавьте исходный ключ администратора для настройки сервера MIM:

    1.  Войдите на портал CM от имени пользователя с правами администратора.

    2.  Выберите пункты **Администрирование** &gt; **Управление шаблонами профилей** и убедитесь, что установлен флажок созданного шаблона профиля, а затем нажмите "Копировать выбранный профиль шаблона".

    3.  Введите имя профиля шаблона, добавьте строку "nonAdmin" и нажмите кнопку **ОК**.

    4.  Когда откроется окно общих параметров шаблона профиля, прокрутите его до конца и в разделе **Smart card Configuration** (Конфигурация смарт-карт) нажмите кнопку **Изменить параметры**.

    5.  В поле **Исходное значение ключа администратора (шестнадцатеричное)** введите ключ администратора по умолчанию: "010203040506070801020304050607080102030405060708"

    6.  Прокрутите вниз и нажмите **ОК**.

5.  **Создание учетной записи без прав администратора на клиентском компьютере**

    Пользователи без прав администратора не могут создать виртуальную смарт-карту на TPM, поэтому ее должен создать администратор.

6.  **Создайте виртуальную смарт-карту с помощью программы командной строки TpmVscMgr.**

    Выполните следующие действия (также от имени администратора), чтобы создать на компьютере пустую виртуальную смарт-карту. Это можно сделать с помощью Intune, SCCM или групповых политик.

    `TpmVscMgr create /name MyVSC /pin default /adminkey default /generate`

7.  **Установите приложение CM в учетной записи без прав администратора.**

8.  **Запустите приложение CM и зарегистрируйте виртуальную смарт-карту.**



<!--HONumber=Jun16_HO4-->


